@if (loading) {
<div class="flex justify-center p-8">
  <p>Loading juntas...</p>
</div>
} @else if (error) {
<div
  class="mb-4 rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700">
  {{ error }}
</div>
} @else if (juntas.length === 0) {
<div
  class="rounded border border-yellow-400 bg-yellow-100 px-4 py-3 text-yellow-700">
  No juntas found. Click the + button to create one.
</div>
} @else {
<div class="mat-elevation-z2">
  <table mat-table [dataSource]="juntas" class="w-full">
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef>Name</th>
      <td mat-cell *matCellDef="let junta">{{ junta.name }}</td>
    </ng-container>

    <ng-container matColumnDef="amount">
      <th mat-header-cell *matHeaderCellDef>Amount</th>
      <td mat-cell *matCellDef="let junta">
        <div class="flex flex-col">
          <span class="font-medium">{{ formatCurrency(junta.amount) }}</span>
          <span class="text-xs text-gray-500">
            {{ formatCurrency(junta.partialAmount) }} per slot
          </span>
        </div>
      </td>
    </ng-container>

    <ng-container matColumnDef="slots">
      <th mat-header-cell *matHeaderCellDef>Slots</th>
      <td mat-cell *matCellDef="let junta">{{ junta.slots }}</td>
    </ng-container>

    <ng-container matColumnDef="dates">
      <th mat-header-cell *matHeaderCellDef>Period</th>
      <td mat-cell *matCellDef="let junta">
        <div class="flex flex-col text-sm">
          <span>{{ junta.startDate | date: 'MMM d, y' }}</span>
          <span class="text-gray-500"
            >to {{ junta.endDate | date: 'MMM d, y' }}</span
          >
        </div>
      </td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>Status</th>
      <td mat-cell *matCellDef="let junta">
        @if (junta.active) {
        <mat-chip class="!bg-green-100 !text-green-800">Active</mat-chip>
        } @else {
        <mat-chip class="!bg-gray-100 !text-gray-800">Finished</mat-chip>
        }
      </td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Actions</th>
      <td mat-cell *matCellDef="let junta" class="space-x-2">
        <button mat-icon-button (click)="onView(junta)">
          <mat-icon>visibility</mat-icon>
        </button>
        <button mat-icon-button color="primary" (click)="onEdit(junta)">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button color="warn" (click)="onDelete(junta)">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>
}
