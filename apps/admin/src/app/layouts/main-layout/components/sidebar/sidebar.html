<div class="flex h-screen w-screen bg-surface-dim">
  <aside
    [style.width]="collapsed() ? '64px' : '256px'"
    class="flex h-full flex-shrink-0 flex-col overflow-hidden border-r border-outline-variant bg-surface-container transition-[width] duration-300 ease-in-out">
    <div
      class="flex items-center border-b border-outline-variant p-2"
      [class.justify-center]="collapsed()"
      [class.justify-between]="!collapsed()">
      @if (!collapsed()) {
      <h2 class="text-primary pl-2 text-xl font-semibold">Logo</h2>
      }
      <button mat-icon-button (click)="toggle()" class="text-muted">
        <mat-icon>{{ collapsed() ? 'menu' : 'menu_open' }}</mat-icon>
      </button>
    </div>

    <div class="flex-grow overflow-y-auto overflow-x-hidden">
      <nav class="flex flex-col gap-1 p-2">
        @for (item of menuItems; track item.route) {
        <a
          [routerLink]="item.route"
          routerLinkActive="bg-primary/20 text-primary"
          [routerLinkActiveOptions]="{ exact: item.exact ?? false }"
          *hasPermission="item.permission ?? null"
          [matTooltip]="collapsed() ? item.label : ''"
          matTooltipPosition="right"
          class="flex items-center gap-3 rounded-lg px-3 py-2 transition-colors hover:bg-surface"
          [class.justify-center]="collapsed()"
          [class.px-2]="collapsed()">
          <mat-icon class="flex-shrink-0">{{ item.icon }}</mat-icon>
          @if (!collapsed()) {
          <span class="whitespace-nowrap">{{ item.label }}</span>
          }
        </a>
        }
      </nav>
    </div>

    <div class="mt-auto border-t border-outline-variant p-2">
      @if (!collapsed()) {
      <p class="mb-2 truncate px-3 text-center text-muted">
        {{ profile.username() }}
      </p>
      <button
        mat-flat-button
        color="warn"
        (click)="logout()"
        class="flex w-full items-center justify-center gap-2">
        <mat-icon>logout</mat-icon>
        <span>Logout</span>
      </button>
      } @else {
      <div class="flex justify-center">
        <button
          mat-icon-button
          color="warn"
          (click)="logout()"
          matTooltip="Logout"
          matTooltipPosition="right">
          <mat-icon>logout</mat-icon>
        </button>
      </div>
      }
    </div>
  </aside>

  <main class="h-full flex-1 overflow-auto p-5">
    <ng-content></ng-content>
  </main>
</div>
